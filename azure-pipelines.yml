trigger: none

pool: my-agent-pool

variables:
  # Replace with values from your Azure DevOps project
  organization: akash66sheoran
  project: my-project  # Adjust if project name differs from working directory
  itemID: 1  # Replace with the ID of your PBI  # Use a Personal Access Token with "vso.work" scope

steps:
- script: |

    sudo apt update && sudo apt install jq -y

    authHeaderValue=$(echo -n ":$(pat)" | base64)

    wiName=$(curl --header "Authorization: Basic $authHeaderValue" --location https://dev.azure.com/$(organization)/$(project)/_apis/wit/workitems/$(itemID)?api-version=7.2-preview.3 | jq -r ".id")
    attachment=$(curl --header "Authorization: Basic $authHeaderValue" --location https://dev.azure.com/$(organization)/$(project)/_apis/wit/workitems/$(itemID)?%24expand=all&api-version=7.2-preview.3 | jq -r ".relations[0].url")

    echo $wiName
    echo $attachment
    #curl --header "Authorization: Basic $authHeaderValue" --location https://dev.azure.com/$(organization)/$(project)/_apis/wit/attachments/08cf7a3d-7d6d-4dde-91f3-4411e3e63e2d?api-version=7.2-preview.3